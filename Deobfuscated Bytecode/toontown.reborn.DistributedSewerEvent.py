# uncompyle6 version 3.9.0
# Python bytecode version base 2.7 (62211)
# Decompiled from: Python 2.7.16 (v2.7.16:413a49145e, Mar  4 2019, 01:30:55) [MSC v.1500 32 bit (Intel)]
# Embedded file name: toontown.reborn.DistributedSewerEvent
# Compiled at: 2014-04-30 09:53:54
from pandac.PandaModules import *
from otp.nametag.NametagConstants import *
from direct.distributed.ClockDelta import *
from direct.interval.IntervalGlobal import *
from direct.distributed.DistributedObject import DistributedObject
from direct.fsm.FSM import FSM
from direct.actor import Actor
from direct.task import Task
from toontown.toon import NPCToons
from toontown.electionsuit import DistributedSuitBase, SuitDNA
from toontown.toonbase import ToontownGlobals
from toontown.battle import BattleProps
from otp.margins.WhisperPopup import *
import InterimElectionGlobals
from direct.directnotify import DirectNotifyGlobal
from random import choice
from direct.interval.LerpInterval import LerpFunctionInterval
from otp.speedchat import SpeedChatGlobals
import SafezoneInvasionRebornGlobals
from toontown.battle.BattleProps import *
from toontown.building.ElevatorUtils import *
from toontown.toonbase import TTLocalizer as TTL
from toontown.chat import ResistanceChat
from toontown.battle import MovieFire

class DistributedSewerEvent(DistributedObject, FSM):
    notify = DirectNotifyGlobal.directNotify.newCategory('DistributedSewerEvent')

    def __init__(self, cr):
        DistributedObject.__init__(self, cr)
        FSM.__init__(self, 'SewerFSM')
        self.cr.sewer = self
        self.geom = base.cr.playGame.hood.loader.geom
        self.cage = base.cr.playGame.hood.loader.cageModel
        self.rocky = NPCToons.createLocalNPC(14001)
        self.rocky.useLOD(1000)
        self.rocky.head = self.rocky.find('**/__Actor_head')
        self.rocky.initializeBodyCollisions('toon')
        self.rocky.setPosHpr(-15.806, -53.269, 0.025, -90, 0, 0)
        self.surlee = NPCToons.createLocalNPC(2019)
        self.surlee.useLOD(1000)
        self.surlee.head = self.surlee.find('**/__Actor_head')
        self.surlee.initializeBodyCollisions('toon')
        self.surlee.setPosHpr(-1.315, 32.972, -0.475, -180, 0, 0)
        self.surleeK = NPCToons.createLocalNPC(2019)
        self.surleeK.useLOD(1000)
        self.surleeK.head = self.surleeK.find('**/__Actor_head')
        self.surleeK.head.setScale(1.75)
        self.surleeK.initializeBodyCollisions('toon')
        for feet in self.surleeK.getPieces(('legs', 'feet')):
            feet.hide()

        self.surleeK.loop('sit')
        self.kart = loader.loadModel('phase_6/models/karting/Kart2_Final')
        self.kart.find('**/decals').setColorScale(0.95, 0.57, 0.12, 1)
        self.kart.find('**/chasse').setColorScale(0.33, 0.33, 0.33, 1)
        self.kart.setPosHpr(-1.581, 165.424, 62.528, 0, 0, 0)
        self.toonSeat = NodePath('toonSeat')
        self.toonSeat.instanceTo(self.kart.find('**/toonNode'))
        self.pitchNode = self.kart.find('**/suspensionNode')
        scale = 1.0 / self.pitchNode.getScale()[0]
        scale /= 2.0
        self.toonSeat.setScale(scale)
        h = (180 + self.pitchNode.getH()) % 360
        self.toonSeat.setH(h)
        pos = Point3(0, -1.3, -4)
        self.toonSeat.setPos(pos)
        self.surleeK.reparentTo(self.toonSeat)
        self.surleeK.setShear(0, 0, 0)
        self.surleeK.setPosHpr(0, 0, 0, 0, 0, 0)
        self.kart.setTransparency(1)
        self.kart.setColorScale(1, 1, 1, 0)
        self.kart.setScale(2)
        cm = CardMaker('card')
        cm.setFrameFullscreenQuad()
        self.explosionCard = render2d.attachNewNode(cm.generate())
        self.explosionCard.setTransparency(1)
        self.explosionCard.setColorScale(0.9, 0.5, 0.3, 0)
        self.sysadmin = DistributedSuitBase.DistributedSuitBase(cr)
        self.sysadmin.dna = SuitDNA.SuitDNA()
        self.sysadmin.dna.newSuit('m8')
        self.sysadmin.setDNA(self.sysadmin.dna)
        self.sysadmin.setDisplayName(TTL.SuitM8 + '\n' + TTL.Hackerbot + '\n' + TTL.Level.title() + ' 15')
        self.sysadmin.setPickable(0)
        self.sysadmin.setPosHpr(35.572, -66.261, 0.025, 25, 0, 0)
        self.sysadmin.doId = id(self.sysadmin)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.sysadmin.attachNewNode(self.collNode)
        self.bigwig = DistributedSuitBase.DistributedSuitBase(cr)
        self.bigwig.dna = SuitDNA.SuitDNA()
        self.bigwig.dna.newSuit('bw')
        self.bigwig.setDNA(self.bigwig.dna)
        self.bigwig.setDisplayName(TTL.SuitBigWig + '\n' + TTL.Lawbot + '\n' + TTL.Level.title() + ' 12')
        self.bigwig.setPickable(0)
        self.bigwig.setPosHpr(47.77, -72.679, 0.025, 58, 0, 0)
        self.bigwig.doId = id(self.bigwig)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.bigwig.attachNewNode(self.collNode)
        self.bloodsucker = DistributedSuitBase.DistributedSuitBase(cr)
        self.bloodsucker.dna = SuitDNA.SuitDNA()
        self.bloodsucker.dna.newSuit('b')
        self.bloodsucker.setDNA(self.bloodsucker.dna)
        self.bloodsucker.setDisplayName(TTL.SuitBloodsucker + '\n' + TTL.Lawbot + '\n' + TTL.Level.title() + ' 6')
        self.bloodsucker.setPickable(0)
        self.bloodsucker.setPosHpr(42.01, -76.338, 0.025, 30, 0, 0)
        self.bloodsucker.doId = id(self.bloodsucker)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.bloodsucker.attachNewNode(self.collNode)
        self.namedropper = DistributedSuitBase.DistributedSuitBase(cr)
        self.namedropper.dna = SuitDNA.SuitDNA()
        self.namedropper.dna.newSuit('nd')
        self.namedropper.setDNA(self.namedropper.dna)
        self.namedropper.setDisplayName(TTL.SuitNameDropper + '\n' + TTL.Sellbot + '\n' + TTL.Level.title() + ' 6')
        self.namedropper.setPickable(0)
        self.namedropper.setPosHpr(43.01, -76.338, -0.475, 0, 0, 0)
        self.namedropper.doId = id(self.namedropper)
        self.namedropper.reparentTo(hidden)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.namedropper.attachNewNode(self.collNode)
        self.mingler = DistributedSuitBase.DistributedSuitBase(cr)
        self.mingler.dna = SuitDNA.SuitDNA()
        self.mingler.dna.newSuit('m')
        self.mingler.setDNA(self.mingler.dna)
        self.mingler.setDisplayName(TTL.SuitTheMingler + '\n' + TTL.Sellbot + '\n' + TTL.Level.title() + ' 10')
        self.mingler.setPickable(0)
        self.mingler.setPosHpr(47.01, -76.338, -0.475, -28, 0, 0)
        self.mingler.doId = id(self.mingler)
        self.mingler.reparentTo(hidden)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.mingler.attachNewNode(self.collNode)
        self.gladhander = DistributedSuitBase.DistributedSuitBase(cr)
        self.gladhander.dna = SuitDNA.SuitDNA()
        self.gladhander.dna.newSuit('gh')
        self.gladhander.setDNA(self.gladhander.dna)
        self.gladhander.setDisplayName(TTL.SuitGladHander + '\n' + TTL.Sellbot + '\n' + TTL.Level.title() + ' 5')
        self.gladhander.setPickable(0)
        self.gladhander.setPosHpr(-5.574, 55.945, -0.475, -178, 0, 0)
        self.gladhander.doId = id(self.gladhander)
        self.gladhander.reparentTo(hidden)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.gladhander.attachNewNode(self.collNode)
        self.gladhander2 = DistributedSuitBase.DistributedSuitBase(cr)
        self.gladhander2.dna = SuitDNA.SuitDNA()
        self.gladhander2.dna.newSuit('gh')
        self.gladhander2.setDNA(self.gladhander2.dna)
        self.gladhander2.setDisplayName(TTL.SuitGladHander + '\n' + TTL.Sellbot + '\n' + TTL.Level.title() + ' 6')
        self.gladhander2.setPickable(0)
        self.gladhander2.setPosHpr(4.613, 55.945, -0.475, -178, 0, 0)
        self.gladhander2.doId = id(self.gladhander2)
        self.gladhander2.reparentTo(hidden)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.gladhander2.attachNewNode(self.collNode)
        self.gladhander3 = DistributedSuitBase.DistributedSuitBase(cr)
        self.gladhander3.dna = SuitDNA.SuitDNA()
        self.gladhander3.dna.newSuit('gh')
        self.gladhander3.setDNA(self.gladhander3.dna)
        self.gladhander3.setDisplayName(TTL.SuitGladHander + '\n' + TTL.Sellbot + '\n' + TTL.Level.title() + ' 7')
        self.gladhander3.setPickable(0)
        self.gladhander3.setPosHpr(-5.574, 69.945, -0.475, -178, 0, 0)
        self.gladhander3.doId = id(self.gladhander3)
        self.gladhander3.reparentTo(hidden)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.gladhander3.attachNewNode(self.collNode)
        self.gladhander4 = DistributedSuitBase.DistributedSuitBase(cr)
        self.gladhander4.dna = SuitDNA.SuitDNA()
        self.gladhander4.dna.newSuit('gh')
        self.gladhander4.setDNA(self.gladhander4.dna)
        self.gladhander4.setDisplayName(TTL.SuitGladHander + '\n' + TTL.Sellbot + '\n' + TTL.Level.title() + ' 8')
        self.gladhander4.setPickable(0)
        self.gladhander4.setPosHpr(4.613, 69.945, -0.475, -178, 0, 0)
        self.gladhander4.doId = id(self.gladhander4)
        self.gladhander4.reparentTo(hidden)
        self.collTube = CollisionTube(0, 0, 0.5, 0, 0, 4, 2)
        self.collNode = CollisionNode('suit')
        self.collNode.addSolid(self.collTube)
        self.collNodePath = self.gladhander4.attachNewNode(self.collNode)
        self.laffMeter = base.localAvatar.laffMeter
        self.book = base.localAvatar.book.bookOpenButton
        self.book2 = base.localAvatar.book.bookCloseButton
        phasePath = 'phase_3.5/audio/dial/'
        self.speechMurmurSfx = loader.loadSfx(phasePath + 'COG_VO_murmur.ogg')
        self.speechStatementSfx = loader.loadSfx(phasePath + 'COG_VO_statement.ogg')
        self.speechQuestionSfx = loader.loadSfx(phasePath + 'COG_VO_question.ogg')
        self.speechGruntSfx = loader.loadSfx(phasePath + 'COG_VO_grunt.ogg')
        self.tunnel = self.geom.find('**/linktunnel_se_14100_DNARoot')
        if self.tunnel:
            self.tunnel.setName('defunct_tunnel')
        self.eventMusic = base.loadMusic('phase_14/audio/bgm/SE_event.ogg')
        self.eventMusic2 = base.loadMusic('phase_14/audio/bgm/SE_stinger_cogs.ogg')
        self.eventMusic3 = base.loadMusic('phase_14/audio/bgm/SE_stinger_cogs_2.ogg')

    def enterOff(self, offset):
        pass

    def exitOff(self):
        pass

    def __cleanupNPCs(self):
        npcs = [
         self.surlee, self.surleeK, self.rocky, self.sysadmin, self.bigwig, self.bloodsucker, self.namedropper, self.mingler, self.gladhander, self.gladhander2, self.gladhander3, self.gladhander4]
        for npc in npcs:
            if npc:
                npc.removeActive()
                npc.hide()

    def delete(self):
        self.demand('Off', 0.0)
        self.ignore('entercnode')
        self.__cleanupNPCs()
        DistributedObject.delete(self)

    def enterIdle(self, offset):
        self.sysadmin.reparentTo(render)
        self.sysadmin.loop('neutral')
        self.sysadmin.addActive()
        self.eventInterval = Sequence(Func(self.sysadmin.setChatAbsolute, "The Toons are starting to pour in. This invasion couldn't have gone better.", CFSpeech | CFTimeout), Wait(8), Func(self.sysadmin.setChatAbsolute, 'I must remember to go meet the Cog Bosses in the Executive Offices.', CFSpeech | CFTimeout), Wait(8), Func(self.sysadmin.setChatAbsolute, 'Unfortunately, our creator failed to give us a boss.', CFSpeech | CFTimeout), Wait(7), Func(self.sysadmin.setChatAbsolute, 'I should not worry about that, they Sellbots should have a Factory open for business soon..', CFSpeech | CFTimeout), Wait(7), Func(self.sysadmin.setChatAbsolute, 'Perhaps I should check my electronic mail...', CFSpeech | CFTimeout), Wait(5), Func(self.sysadmin.setChatAbsolute, "Unfortunate. 25 unread memos from Big Wig 8675309-42A. A Cog could suffocate under all of the Lawbot's needless paperwork.", CFSpeech | CFTimeout), Wait(9), Func(self.sysadmin.setChatAbsolute, 'Then again, I should look on the bright side...', CFSpeech | CFTimeout), Wait(6))
        self.eventInterval.loop()
        self.eventInterval.setT(offset)

    def exitIdle(self):
        self.eventInterval.finish()

    def enterEvent(self, offset):
        base.cr.playGame.hood.loader.music.stop()
        self.sysadmin.reparentTo(render)
        self.sysadmin.loop('neutral')
        self.sysadmin.addActive()
        bwFlyIn = self.bigwig.beginSupaFlyMove(VBase3(47.77, -72.679, 0.025), 1, 'flyIn', walkAfterLanding=False)
        bsFlyIn = self.bloodsucker.beginSupaFlyMove(VBase3(42.01, -76.338, 0.025), 1, 'flyIn', walkAfterLanding=False)
        self.eventInterval = Sequence(Func(base.camera.wrtReparentTo, render), Func(base.localAvatar.stopUpdateSmartCamera), Func(base.localAvatar.shutdownSmartCamera), Func(NodePath(self.book).hide), Func(NodePath(base.marginManager).hide), Func(NodePath(self.laffMeter).hide), base.camera.posHprInterval(5, (50.645,
                                                                                                                                                                                                                                                                                                                      -44.602,
                                                                                                                                                                                                                                                                                                                      5.325), (-203,
                                                                                                                                                                                                                                                                                                                               4,
                                                                                                                                                                                                                                                                                                                               0), blendType='easeInOut'), Func(base.playMusic, self.eventMusic, looping=0, volume=0.9), Func(self.sysadmin.setChatAbsolute, 'The plan is almost complete. This buisness merger has proven to be a success.', CFSpeech | CFTimeout), Wait(5), Func(self.sysadmin.setChatAbsolute, "I should report back to the bosses. They'll be pleased that the Toons have been cap-", CFSpeech | CFTimeout), Wait(4), Parallel(Func(self.bloodsucker.reparentTo, render), Func(self.bloodsucker.addActive), Func(self.bigwig.reparentTo, render), Func(self.bigwig.addActive)), Parallel(Func(bsFlyIn.start, offset), Func(bwFlyIn.start, offset)), Wait(4), Func(self.sysadmin.loop, 'walk'), Func(self.sysadmin.setChatAbsolute, "Ah, Lawbots, as if on cue. I've had enough of their ridiculous laws for a lifetime.", CFSpeech | CFTimeout), self.sysadmin.hprInterval(2, (-140,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0)), Func(self.sysadmin.loop, 'neutral'), Wait(3), Parallel(Func(self.bloodsucker.loop, 'neutral'), Func(self.bigwig.loop, 'neutral')), Func(self.bigwig.setChatAbsolute, "Mr. Sysadmin. I've sent you at least 25 memos today. Have you been out of office?", CFSpeech | CFTimeout, dialogue=self.speechMurmurSfx), Wait(4), Func(self.sysadmin.setChatAbsolute, "Apologies. I've been out all day making last minute tweaks to the Cog Apprehensioner of Guffawing Ectorganisms.", CFSpeech | CFTimeout), Wait(6), Func(self.bigwig.setChatAbsolute, 'Right. Are you sure about Cog Nation Central? Surrounding ourselves with Toons does not sound appealing.', CFSpeech | CFTimeout), Wait(5), Func(self.sysadmin.setChatAbsolute, 'Of course. Failure is not something recognized in our system coding. Cog Nation Central should give a massive boost to productivity...', CFSpeech | CFTimeout), Wait(7), Func(self.sysadmin.setChatAbsolute, '...speaking of, our new friends here should give a boost as well.', CFSpeech | CFTimeout), Wait(5), Func(self.sysadmin.setChatAbsolute, 'I am considered the head of my department, after all, at least until the Portable Executive is built. You know the Chairman rarely gives promotions past level 12.', CFSpeech | CFTimeout, dialogue=self.speechMurmurSfx), Wait(8), Func(self.sysadmin.setChatAbsolute, 'Besides, we have direct approval from the Chairman. That should be enough, even for your convoluted rules and regulations.', CFSpeech | CFTimeout), Wait(6), Func(self.bloodsucker.setChatAbsolute, 'Very well. We just needed to be sure. After all, your department is new to Cog Nation.', CFSpeech | CFTimeout), Wait(5), Func(self.bloodsucker.setChatAbsolute, 'One more thing. Can you guarantee these Toons will be stored safely for... future use?', CFSpeech | CFTimeout), Wait(6), Func(self.sysadmin.setChatAbsolute, "I've programmed this cage to only open for true Cogs. It's probably even safer than how you're storing the duck.", CFSpeech | CFTimeout, dialogue=self.speechMurmurSfx), Wait(7))
        self.eventInterval.start()
        self.eventInterval.setT(offset)

    def exitEvent(self):
        self.eventInterval.finish()

    def fireCog(self, suit, hp):
        toonTracks = Parallel()
        fire = {'toon': self.rocky, 'hpbonus': 0, 'target': {'suit': suit, 'hp': hp, 'kbbonus': 0, 'died': 0, 'revived': 0, 'leftSuits': [], 'rightSuits': []}, 'sidestep': 0, 'level': 0, 'battle': render}
        tracks = MovieFire.throwPie(fire, 0, 1, 1)
        if tracks:
            for track in tracks:
                toonTracks.append(track)

        toonTracks.append(Parallel(Func(suit.show), Func(suit.removeActive), Func(self.tunnel.setName, 'linktunnel_se_14100_DNARoot')))
        return toonTracks

    def enterEventTwo(self, offset):
        self.sysadmin.reparentTo(render)
        self.sysadmin.loop('neutral')
        self.sysadmin.addActive()
        self.bigwig.reparentTo(render)
        self.bigwig.loop('neutral')
        self.bigwig.addActive()
        self.bloodsucker.reparentTo(render)
        self.bloodsucker.loop('neutral')
        self.bloodsucker.addActive()

        def fireAll():
            suits = [
             self.mingler, self.namedropper, self.gladhander, self.gladhander2, self.gladhander3, self.gladhander4]
            hp = [132, 56, 42, 56, 72, 90]
            for suit in suits:
                self.fireCog(suit, hp[suits.index(suit)]).start()

        base.playMusic(base.cr.playGame.hood.loader.music)
        bwFlyOut = self.bigwig.beginSupaFlyMove(VBase3(47.77, -72.679, 0.025), 0, 'flyOut')
        bsFlyOut = self.bloodsucker.beginSupaFlyMove(VBase3(42.01, -76.338, 0.025), 0, 'flyOut')
        m8FlyOut = self.sysadmin.beginSupaFlyMove(VBase3(35.572, -66.261, 0.025), 0, 'flyOut')
        ndFlyIn = self.namedropper.beginSupaFlyMove(VBase3(4.989, 93.245, -0.475), 1, 'flyIn', walkAfterLanding=False)
        mFlyIn = self.mingler.beginSupaFlyMove(VBase3(-3.725, 102.799, -0.475), 1, 'flyIn', walkAfterLanding=False)
        ghFlyIn = self.gladhander.beginSupaFlyMove(VBase3(-5.574, 55.945, -0.475), 1, 'flyIn', walkAfterLanding=False)
        gh2FlyIn = self.gladhander2.beginSupaFlyMove(VBase3(4.613, 55.945, -0.475), 1, 'flyIn', walkAfterLanding=False)
        gh3FlyIn = self.gladhander3.beginSupaFlyMove(VBase3(-5.574, 69.945, -0.475), 1, 'flyIn', walkAfterLanding=False)
        gh4FlyIn = self.gladhander4.beginSupaFlyMove(VBase3(4.613, 69.945, -0.475), 1, 'flyIn', walkAfterLanding=False)
        self.turboStart = loader.loadSfx('phase_6/audio/sfx/KART_turboStart.ogg')
        self.turboLoop = loader.loadSfx('phase_6/audio/sfx/KART_turboLoop.ogg')
        self.explode = loader.loadSfx('phase_14/audio/sfx/explode_into_tinnitus.ogg')
        self.musicInterval = Sequence(Func(base.playMusic, self.eventMusic, volume=0.9, time=77), Wait(29), Func(base.playMusic, base.cr.playGame.hood.loader.music, looping=1))
        self.rockyWalkInterval = Sequence(Func(self.rocky.loop, 'walk'), self.rocky.posHprInterval(12, (-15.806,
                                                                                                        6.225,
                                                                                                        0.025), (0,
                                                                                                                 0,
                                                                                                                 0)), Func(self.rocky.loop, 'neutral'))
        self.eventInterval3 = Sequence(Func(self.rocky.setChatAbsolute, 'Well, that was a close one. To the Sewers!', CFSpeech | CFTimeout), Wait(14), Func(self.rocky.setChatAbsolute, "What are you waiting for? Let's go!", CFSpeech | CFTimeout), Wait(14), Func(self.rocky.setChatAbsolute, 'I think Surlee will be waiting for us by now... come on!', CFSpeech | CFTimeout), Wait(22))
        self.eventInterval2 = Sequence(Func(self.musicInterval.start), Func(self.bigwig.setChatAbsolute, "I guess I can trust that. Send my regards to your department. We'll be off to Cog Metropolis.", CFSpeech | CFTimeout), Wait(1), Func(bwFlyOut.start), Wait(2), Parallel(Func(bsFlyOut.start), Func(m8FlyOut.start)), base.camera.posHprInterval(3, (46.645,
                                                                                                                                                                                                                                                                                                                                                              -48.602,
                                                                                                                                                                                                                                                                                                                                                              4.325), (-270,
                                                                                                                                                                                                                                                                                                                                                                       0,
                                                                                                                                                                                                                                                                                                                                                                       0), blendType='easeInOut'), Wait(4), Parallel(Func(self.bloodsucker.reparentTo, hidden), Func(self.bloodsucker.removeActive), Func(self.bigwig.reparentTo, hidden), Func(self.bigwig.removeActive), Func(self.sysadmin.reparentTo, hidden), Func(self.sysadmin.removeActive)), base.camera.posHprInterval(2, (-29.145,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -52.802,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     3.325), (-90,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0), blendType='easeInOut'), Wait(3), Parallel(Func(self.rocky.reparentTo, render), Func(self.rocky.addActive), Func(self.rocky.animFSM.request, 'TeleportIn')), Func(self.rocky.setChatAbsolute, 'No matter what approach the Cogs use to try and defeat us...', CFSpeech | CFTimeout), Wait(3), Func(self.rocky.loop, 'neutral'), Wait(2), Func(self.rocky.setChatAbsolute, "...they're still thicker than the oil they drink.", CFSpeech | CFTimeout), Func(self.rocky.loop, 'walk'), self.rocky.hprInterval(2, (0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0)), Func(self.rocky.loop, 'neutral'), Wait(3), Func(self.rocky.setChatAbsolute, 'All clear, Surlee! Come on out!', CFSpeech | CFTimeout), base.camera.posHprInterval(4, (-73.545,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           38.302,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           5.325), (-100,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    8,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0), blendType='easeInOut'), Func(base.playSfx, self.turboStart), Wait(2), Parallel(Func(base.playSfx, self.turboLoop), Func(self.kart.reparentTo, render), Func(self.surleeK.addActive), self.kart.colorScaleInterval(0.5, (1,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1)), ProjectileInterval(self.kart, endPos=Point3(-1.472, 30.483, 10.53), duration=2), Func(self.surleeK.setChatAbsolute, 'INCOMING!', CFSpeech | CFTimeout)), Func(base.playSfx, self.explode), self.explosionCard.colorScaleInterval(0.25, (0.9,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0.5,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0.3,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1)), Func(self.kart.reparentTo, hidden), Func(self.cage.reparentTo, hidden), Func(self.surleeK.removeActive), Func(self.surlee.addActive), Func(self.surlee.reparentTo, render), Func(self.surlee.animFSM.request, 'neutral'), Func(base.localAvatar.attachCamera), Func(base.localAvatar.initializeSmartCamera), Func(base.localAvatar.startUpdateSmartCamera), Wait(2), self.explosionCard.colorScaleInterval(2, (0.9,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.5,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.3,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0)), Func(NodePath(base.marginManager).show), Func(NodePath(self.laffMeter).show), Func(NodePath(self.book).show), Func(self.surlee.setChatAbsolute, 'That could have been worse... you Toons look a little down.', CFSpeech | CFTimeout), Wait(4), Func(self.surlee.setChatAbsolute, 'Toons of the World, Toon-up!', CFSpeech | CFTimeout), Func(self.sendUpdate, 'applyReward', []), Func(ResistanceChat.doEffect, 3, self.surlee, [base.localAvatar]), ActorInterval(self.surlee, 'victory', playRate=0.75, startFrame=0, endFrame=9), ActorInterval(self.surlee, 'victory', playRate=0.75, startFrame=9, endFrame=0), Func(self.surlee.loop, 'neutral'), Wait(5), Func(self.surlee.setChatAbsolute, 'This is absolutely awful. The Cog invasion was a success! Toontown Central has been taken over!', CFSpeech | CFTimeout), Wait(6), Func(self.surlee.setChatAbsolute, "It's all because of those new Cogs, the Hackerbots.", CFSpeech | CFTimeout), Wait(5), Func(self.surlee.setChatAbsolute, '"Make Toontown more challenging..." You should\'ve known to start small...', CFThought | CFTimeout), Func(self.rocky.setChatAbsolute, "Toons, I've figured out where we are.", CFSpeech | CFTimeout), Wait(4), Func(self.rocky.setChatAbsolute, 'This is an entrance to the Cog Sewer System. That means if this tunnel is correct...', CFSpeech | CFTimeout), Func(self.rocky.loop, 'walk'), self.rocky.hprInterval(4, (190,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0)), Func(self.rocky.loop, 'neutral'), Wait(1), Func(self.surlee.setChatAbsolute, '', CFSpeech | CFTimeout), Func(self.rocky.setChatAbsolute, '...it should lead right to Toontown Central.', CFSpeech | CFTimeout), Wait(5), Func(self.rocky.setChatAbsolute, 'Now hurry! Before any Cogs find out we...', CFSpeech | CFTimeout), Wait(3), Func(base.playMusic, self.eventMusic2, looping=0, volume=0.9), Func(self.rocky.loop, 'walk'), self.rocky.hprInterval(2, (0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0)), Func(self.rocky.loop, 'neutral'), Func(self.surlee.loop, 'walk'), self.surlee.hprInterval(2, (0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0)), Func(self.surlee.loop, 'neutral'), Func(self.rocky.setChatAbsolute, "What's that sound?", CFSpeech | CFTimeout), Wait(2), Func(self.surlee.setChatAbsolute, 'Uh-oh!', CFSpeech | CFTimeout), Parallel(Func(self.mingler.reparentTo, render), Func(self.mingler.addActive)), Func(mFlyIn.start, offset), Wait(3), Parallel(Func(self.namedropper.reparentTo, render), Func(self.namedropper.addActive)), Func(ndFlyIn.start, offset), Wait(4), Func(self.mingler.setChatAbsolute, 'Oh, hello, Ms. Name Dropper. On your lunch break?', CFSpeech | CFTimeout), Wait(5), Func(self.namedropper.setChatAbsolute, 'Not at the moment. I was asked to check on the Toons by the Vice President.', CFSpeech | CFTimeout), Wait(6), Func(self.namedropper.setChatAbsolute, "He's not too confident in the Hackerbots. He hasn't even commissioned drafts of the Hackerbot Factory, and they don't even have a Boss yet.", CFSpeech | CFTimeout), Wait(7), Func(self.namedropper.setChatAbsolute, "I hope you don't mind if I drop a few names; I met an Assembly Assasian. I have confidence in the new Cogs.", CFSpeech | CFTimeout), Wait(6), Func(self.rockyWalkInterval.start), Func(self.mingler.setChatAbsolute, 'I concur. Perhaps mingling with the new Cogs is...', CFSpeech | CFTimeout), Func(self.mingler.loop, 'walk'), self.mingler.hprInterval(2, (-178,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0)), Func(self.mingler.loop, 'neutral'), Wait(2), Func(self.mingler.setChatAbsolute, 'What is this?! The Toons have escaped!', CFSpeech | CFTimeout), Func(self.namedropper.loop, 'walk'), self.namedropper.hprInterval(2, (-178,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0)), Func(self.namedropper.loop, 'neutral'), Wait(2), Func(base.playMusic, self.eventMusic3, looping=0, volume=0.9), Func(self.surlee.setChatAbsolute, 'Dear Walt! Toons, get to the sewers, quick!', CFSpeech | CFTimeout), Func(self.surlee.animFSM.request, 'TeleportOut'), Wait(4), Parallel(Func(self.namedropper.setChatAbsolute, 'I think I should call for some help. Penny Pincher 00 was kind enough to lend me some of his summons.', CFSpeech | CFTimeout)), Func(self.surlee.setChatAbsolute, '', CFSpeech | CFTimeout), Func(self.surlee.removeActive), Func(self.surlee.hide), Wait(3), Parallel(Func(self.mingler.setChatAbsolute, "How handy. Activate them; the signal's weak but it shouldn't take too long.", CFSpeech | CFTimeout)), Wait(3), Parallel(Func(self.gladhander.reparentTo, render), Func(self.gladhander.addActive), Func(self.gladhander2.reparentTo, render), Func(self.gladhander2.addActive), Func(ghFlyIn.start, offset), Func(gh2FlyIn.start, offset)), Wait(4), Func(self.gladhander.setChatAbsolute, 'Perhaps we can lend you a hand, Toons?', CFSpeech | CFTimeout), Wait(2), Parallel(Func(self.gladhander4.setChatAbsolute, "We're quite fit to seal the deal this time.", CFSpeech | CFTimeout), Func(self.rocky.setChatAbsolute, "Toons, get into the tunnel, quickly! I've got these menacing Glad Handers.", CFSpeech | CFTimeout)), Parallel(Func(self.gladhander3.reparentTo, render), Func(self.gladhander3.addActive), Func(self.gladhander4.reparentTo, render), Func(self.gladhander4.addActive), Func(gh3FlyIn.start, offset), Func(gh4FlyIn.start, offset)), Wait(9), Func(fireAll), Wait(8.5), Func(self.rocky.setChatAbsolute, 'Looks like those Cogs dropped some spare pink slips. Here, take some.', CFSpeech | CFTimeout), Func(self.sendUpdate, 'applyReward2', []), Func(self.eventInterval3.loop))
        self.eventInterval2.start()
        self.eventInterval2.setT(offset)

    def exitEventTwo(self):
        self.eventInterval2.finish()
        self.eventInterval3.finish()

    def setState(self, state, timestamp):
        self.request(state, globalClockDelta.localElapsedTime(timestamp))